<div align="center">

<br/>

```
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘
â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•  â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘
â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•â•    â•šâ•â•  â•šâ•â•â•šâ•â•
```

### **AI Shelf Intelligence for India's 12 Million Kirana Stores**

*Photo in. Voice recommendation out. 30 seconds.*

<br/>

[![Python](https://img.shields.io/badge/Python-3.11+-8b5cf6?style=for-the-badge&logo=python&logoColor=white)](https://python.org)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.115-7c3aed?style=for-the-badge&logo=fastapi&logoColor=white)](https://fastapi.tiangolo.com)
[![Gemini](https://img.shields.io/badge/Gemini_1.5_Pro-Vision-a855f7?style=for-the-badge&logo=google&logoColor=white)](https://deepmind.google/technologies/gemini/)
[![AMD](https://img.shields.io/badge/AMD_Slingshot-Hackathon-6d28d9?style=for-the-badge&logo=amd&logoColor=white)](https://amd.com)
[![License](https://img.shields.io/badge/License-MIT-4c1d95?style=for-the-badge)](LICENSE)

<br/>

> **Built for AMD Slingshot Hackathon** â€” Team Technovator

<br/>

---

</div>

## The Problem

India has **12 million kirana stores**. Each owner wakes up not knowing which products are running out, which shelves are disorganised, or what their neighbourhood is short on. They have no scanner, no ERP, no inventory system. They have a phone and WhatsApp.

ShelfScan AI gives every kirana owner a **personal AI retail analyst in their pocket** â€” no app download, no training required. They photograph their shelf. We send back a Hindi voice note telling them exactly what to order, how much, and why.

---

## How It Works

```
Owner takes photo of shelf
        â”‚
        â–¼
Sends to ShelfScan WhatsApp number
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ShelfScan AI Pipeline                  â”‚
â”‚                                                           â”‚
â”‚  ğŸ“¸ Cloudinary CDN â”€â”€â–º ğŸ‘ï¸ Gemini 1.5 Pro Vision          â”‚
â”‚                              â”‚                            â”‚
â”‚                     Detects every product                 â”‚
â”‚                     Stock levels, facing,                 â”‚
â”‚                     shelf health score                    â”‚
â”‚                              â”‚                            â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚              â–¼               â–¼               â–¼            â”‚
â”‚        ğŸ¤ PRESENTER    âš–ï¸ CRITIC       ğŸ¯ DECIDER          â”‚
â”‚        Gemini Pro      GPT-4o Mini    Gemini Pro           â”‚
â”‚        Build plan      Challenge it   Synthesise          â”‚
â”‚        (urgency +      (cash flow +   (final ranked       â”‚
â”‚        revenue)        expiry risk)    action plan)       â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                              â”‚                            â”‚
â”‚                    ğŸ™ï¸ ElevenLabs Hindi TTS                â”‚
â”‚                    Natural voice note (MP3)               â”‚
â”‚                              â”‚                            â”‚
â”‚                    ğŸ’¾ Supabase PostgreSQL                  â”‚
â”‚                    (8 tables, all data saved)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
Owner receives Hindi voice note on WhatsApp
"Namaskar bhai! Tata Salt aur Parle-G aaj hi mangaiye..."
```

**Total time: ~30 seconds from photo to voice note.**

---

## Features

### ğŸ§  3-Agent AI Debate System
The core innovation. Not one AI opinion â€” a structured debate between three specialist agents, each with a different perspective:

| Agent | Model | Role |
|-------|-------|------|
| **Presenter** | Gemini 1.5 Pro | Builds the most comprehensive restock plan â€” urgency, quantities, revenue at risk |
| **Critic** | GPT-4o Mini â†’ Groq LLaMA-3.1 â†’ Gemini Flash | Stress-tests the plan against real cash flow constraints (kirana daily revenue: â‚¹2Kâ€“â‚¹10K) |
| **Decider** | Gemini 1.5 Pro | Synthesises the debate into a final ranked action plan, then writes the Hindi voice note |

The Critic has a **priority fallback chain** â€” it tries GPT-4o Mini first, then free Groq, then free Together AI, then Gemini Flash. The system works even if you have zero paid API keys.

### ğŸ‘ï¸ Gemini Vision Analysis
Every product on the shelf is detected and characterised:
- **Name & brand** â€” read directly from labels
- **Stock level** â€” `critical` / `low` / `ok` / `overstocked`
- **Shelf position** â€” `top` / `middle` / `bottom` / `eye_level`
- **Facing** â€” is the label pointing toward the customer?
- **Overall health score** â€” 0 to 100

### ğŸ™ï¸ Hindi Voice Notes
ElevenLabs `eleven_multilingual_v2` model generates natural Hindi/Hinglish audio â€” warm, conversational, like a knowledgeable friend calling you. Uploaded to Cloudinary CDN, delivered via WhatsApp.

### ğŸ“ Neighbourhood Intelligence
Demand data is aggregated by pincode nightly. Owners see:
- What products are running out across their neighbourhood
- Which categories are in high demand locally
- How their shelf health compares to nearby stores

### ğŸ“± WhatsApp-First Interface
No app download. No login. Just WhatsApp â€” the interface 500M+ Indians already use every day. The full AI pipeline triggers from a single photo message.

### ğŸŒ Web Dashboard
A full single-file dashboard (`shelfscan-v3.html`) for owners who prefer a browser interface â€” scan history, inventory tracking, debate logs, voice note archive, neighbourhood map.

---

## Tech Stack

```
Backend          FastAPI + Uvicorn (Python 3.11)
Database         Supabase (PostgreSQL + Row Level Security)
Vision AI        Google Gemini 1.5 Pro
Presenter AI     Google Gemini 1.5 Pro
Critic AI        GPT-4o Mini â†’ Groq LLaMA-3.1-70B â†’ Together Mixtral â†’ Gemini Flash
Decider AI       Google Gemini 1.5 Pro
Voice TTS        ElevenLabs eleven_multilingual_v2
Image Storage    Cloudinary CDN
Audio Storage    Cloudinary CDN
WhatsApp         Twilio Messaging API
Deployment       Railway
Frontend         Vanilla HTML/CSS/JS (zero dependencies, single file)
```

---

## Project Structure

```
shelfscan-backend/
â”œâ”€â”€ main.py                    â† FastAPI app â€” 12 REST routes + WhatsApp webhook
â”œâ”€â”€ config.py                  â† All service configurations
â”œâ”€â”€ database.py                â† Supabase client
â”œâ”€â”€ models.py                  â† Pydantic request/response models
â”œâ”€â”€ schema.sql                 â† PostgreSQL schema (8 tables, indexes, RLS)
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ Procfile                   â† Railway/Heroku deployment
â”œâ”€â”€ .env.example
â”œâ”€â”€ shelfscan-v3.html          â† Complete web dashboard (single file)
â””â”€â”€ services/
    â”œâ”€â”€ vision_service.py      â† Gemini 1.5 Pro Vision â€” shelf analysis
    â”œâ”€â”€ debate_service.py      â† 3-Agent debate orchestration
    â”œâ”€â”€ voice_service.py       â† ElevenLabs Hindi TTS + Cloudinary upload
    â”œâ”€â”€ cloudinary_service.py  â† Image + audio CDN management
    â”œâ”€â”€ neighborhood_service.pyâ† Pincode demand data queries
    â”œâ”€â”€ twilio_service.py      â† WhatsApp inbound/outbound helpers
    â””â”€â”€ aggregation_service.py â† Nightly pincode demand aggregation
```

---

## Getting Started

### Prerequisites
- Python 3.11+
- A Supabase account (free tier works)
- Gemini API key (Google AI Studio â€” free)

### 1. Database Setup

```bash
# Open your Supabase project's SQL Editor and run schema.sql
# Creates: stores, scans, detected_products, debate_rounds,
#          voice_notes, product_catalog, neighborhood_demand, whatsapp_messages
```

### 2. Install & Run

```bash
git clone https://github.com/your-username/shelfscan-ai
cd shelfscan-ai

pip install -r requirements.txt
python main.py
# â†’ http://localhost:8000/docs
```

### 3. Open the Dashboard

```bash
open shelfscan-v3.html
# No server required â€” it's a single HTML file
```

### 4. WhatsApp Setup (Optional)

```bash
# 1. Create a Twilio account â†’ get Account SID + Auth Token
# 2. Go to Messaging â†’ WhatsApp Sandbox â†’ enable sandbox
# 3. Set webhook URL: https://YOUR-URL/webhook/whatsapp (POST)

export TWILIO_ACCOUNT_SID="ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
export TWILIO_AUTH_TOKEN="your_auth_token"
export TWILIO_WHATSAPP_NUMBER="+14155238886"
```

---

## API Reference

| Method | Endpoint | Description |
|--------|----------|-------------|
| `GET` | `/` | Health check |
| `GET` | `/health` | Status + timestamp |
| `POST` | `/api/stores/register` | Register new kirana store |
| `GET` | `/api/stores/login/{whatsapp}` | Login by WhatsApp number |
| `GET` | `/api/stores/{store_id}` | Get store details |
| `POST` | `/api/scan` | **Full AI pipeline** â€” image â†’ vision â†’ debate â†’ voice â†’ DB |
| `GET` | `/api/dashboard/{store_id}` | All dashboard data |
| `GET` | `/api/scans/{store_id}` | Scan history with debates + voice notes |
| `GET` | `/api/scan/{scan_id}/details` | Full scan detail |
| `GET` | `/api/neighborhood/{pincode}` | Pincode demand intelligence |
| `GET` | `/api/voice/{scan_id}` | Voice note for a scan |
| `POST` | `/webhook/whatsapp` | **Twilio WhatsApp webhook** |

Full interactive docs at `http://localhost:8000/docs` when running locally.

---

## Environment Variables

```bash
# Required for WhatsApp feature
TWILIO_ACCOUNT_SID=ACxxxxxxxx
TWILIO_AUTH_TOKEN=your_token
TWILIO_WHATSAPP_NUMBER=+14155238886

# Optional â€” better Critic reasoning (system works without these)
OPENAI_API_KEY=sk-...          # GPT-4o Mini (~â‚¹0.08/scan)
GROQ_API_KEY=gsk_...           # LLaMA-3.1-70B â€” FREE at console.groq.com
TOGETHER_API_KEY=...           # Mixtral-8x7B â€” FREE $1 credit at api.together.xyz
```

The following are pre-configured for demo use (hardcoded in `config.py`):
Supabase, Gemini, Cloudinary, ElevenLabs.

---

## Deployment

### Railway (Recommended)

```bash
npm install -g @railway/cli
railway login
railway new
railway up
```

Add environment variables in the Railway dashboard. The `Procfile` and `railway.json` are already configured.

```bash
# Then update the frontend to point to your live backend
# In shelfscan-v3.html, line ~871:
const API_BASE = 'https://YOUR-APP.up.railway.app';
```

### Nightly Aggregation

```bash
# Run the pincode demand aggregation job manually
python -c "
import asyncio
from services.aggregation_service import run_aggregation
asyncio.run(run_aggregation())
"

# Or schedule via Railway cron: 0 2 * * *
```

---

## Database Schema

| Table | Purpose |
|-------|---------|
| `stores` | Registered kirana store owners |
| `scans` | Each shelf scan â€” image URL, health score, final recommendation |
| `detected_products` | Every product found in each scan |
| `debate_rounds` | All three agent outputs per scan |
| `voice_notes` | Hindi audio URL + text per scan |
| `product_catalog` | Global FMCG reference (seeded with 15 common products) |
| `neighborhood_demand` | Weekly pincode-level demand aggregation |
| `whatsapp_messages` | Full inbound/outbound WhatsApp message log |

All tables have Row Level Security enabled. Indexes on all foreign keys and frequently queried columns.

---

## The AMD Connection

ShelfScan AI is built for deployment on AMD hardware:

- **AMD Instinct MI300X GPUs** â€” run local Gemini-class vision models at inference time (production scale)
- **AMD Ryzen AI Edge** â€” on-device pre-processing for shelf images before cloud upload, reducing latency to under 5 seconds
- **ROCm Software Stack** â€” enables the full AI pipeline to run on AMD silicon without CUDA dependency

The multi-agent debate architecture is specifically designed to exploit AMD's high-memory bandwidth (MI300X has 192GB HBM3) â€” all three agents can be loaded simultaneously and queried in parallel.

---

## Roadmap

- [ ] **Real-time shelf monitoring** â€” continuous CCTV feed analysis, not just on-demand photos
- [ ] **Distributor integration** â€” auto-raise purchase orders when stock hits critical
- [ ] **Price intelligence** â€” OCR price tags, detect if margins are being maintained
- [ ] **Multi-shelf stitching** â€” combine multiple photos into a complete store view
- [ ] **Regional language support** â€” Tamil, Marathi, Telugu, Bengali voice notes
- [ ] **Predictive restocking** â€” ML models trained on scan history to predict stockouts before they happen
- [ ] **WhatsApp Business API** â€” move from sandbox to verified business number

---

## Contributing

Pull requests are welcome. For major changes, open an issue first.

```bash
git checkout -b feature/your-feature
git commit -m "feat: your feature description"
git push origin feature/your-feature
```

---

## License

MIT â€” see [LICENSE](LICENSE) for details.

---

<div align="center">

**Built with obsession at the AMD Slingshot Hackathon**

*For India's kirana store owners who deserve better tools.*

<br/>

`Gemini` Â· `ElevenLabs` Â· `Supabase` Â· `Cloudinary` Â· `Twilio` Â· `FastAPI` Â· `AMD`

</div>
